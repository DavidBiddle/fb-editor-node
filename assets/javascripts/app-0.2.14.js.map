{"version":3,"sources":["webpack://@ministryofjustice/fb-editor-node/./src/js/shortcuts.js","webpack://@ministryofjustice/fb-editor-node/webpack/bootstrap","webpack://@ministryofjustice/fb-editor-node/./src/js/app.js"],"names":["module","exports","allShortcuts","add","shortcutCombination","callback","opt","defaultOptions","type","propagate","disable_in_input","target","document","keycode","dfo","ele","getElementById","toLowerCase","func","element","code","e","window","event","srcElement","nodeType","parentNode","tagName","keyCode","which","character","String","fromCharCode","keys","split","kp","shiftNums","1","2","3","4","5","6","7","8","9","0","'","specialKeys","esc","escape","tab","space","return","enter","backspace","scrolllock","scroll_lock","scroll","capslock","caps_lock","caps","numlock","num_lock","num","pause","break","insert","home","delete","end","pageup","page_up","pu","pagedown","page_down","pd","left","up","right","down","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","modifiers","shift","wanted","pressed","ctrl","alt","meta","ctrlKey","shiftKey","altKey","metaKey","k","i","length","cancelBubble","returnValue","stopPropagation","preventDefault","this","addEventListener","attachEvent","remove","binding","detachEvent","removeEventListener","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","shortcuts","require","addShortcut","char","modeNav","stub","urlLink","querySelector","location","href","getAttribute","match","replace","RegExp","upNav","newHref","urlLinks","Array","from","querySelectorAll","flowNav","direction","link","includes","startsWith"],"mappings":"qBAMAA,EAAOC,QAAU,CACfC,aAAc,GAGdC,IAJe,SAIVC,EAAqBC,EAAUC,GAElC,IAAMC,EAAiB,CACrBC,KAAM,UACNC,WAAW,EACXC,kBAAkB,EAClBC,OAAQC,SACRC,SAAS,GAEX,GAAKP,EAEH,IAAK,IAAMQ,KAAOP,OACQ,IAAbD,EAAIQ,KAAsBR,EAAIQ,GAAOP,EAAeO,SAHzDR,EAAMC,EAOhB,IAAIQ,EAAMT,EAAIK,OACY,iBAAfL,EAAIK,SAAqBI,EAAMH,SAASI,eAAeV,EAAIK,SAEtEP,EAAsBA,EAAoBa,cAG1C,IAAMC,EAAO,WAA4B,IAEjCC,EAQFC,EAViBC,EAAkB,uDAAdC,OAAOC,MAChC,GAAIjB,EAAII,mBAEFW,EAAEV,OAAQQ,EAAUE,EAAEV,OACjBU,EAAEG,aAAYL,EAAUE,EAAEG,YACV,IAArBL,EAAQM,WAAgBN,EAAUA,EAAQO,YAEtB,UAApBP,EAAQQ,SAA2C,aAApBR,EAAQQ,SAAwB,OAKjEN,EAAEO,QAASR,EAAOC,EAAEO,QACfP,EAAEQ,QAAOT,EAAOC,EAAEQ,OAE3B,IAAIC,EAAYC,OAAOC,aAAaZ,GAAMH,cAE7B,MAATG,IAAcU,EAAY,KACjB,MAATV,IAAcU,EAAY,KAE9B,IAAMG,EAAO7B,EAAoB8B,MAAM,KAEnCC,EAAK,EAGHC,EAAY,CAChB,IAAK,IACLC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACH,IAAK,IACL,IAAK,IACL,IAAK,IACLC,IAAM,IACN,IAAK,IACL,IAAK,IACL,IAAK,IACL,KAAM,KAGFC,EAAc,CAClBC,IAAK,GACLC,OAAQ,GACRC,IAAK,EACLC,MAAO,GACPC,OAAQ,GACRC,MAAO,GACPC,UAAW,EAEXC,WAAY,IACZC,YAAa,IACbC,OAAQ,IACRC,SAAU,GACVC,UAAW,GACXC,KAAM,GACNC,QAAS,IACTC,SAAU,IACVC,IAAK,IAELC,MAAO,GACPC,MAAO,GAEPC,OAAQ,GACRC,KAAM,GACNC,OAAQ,GACRC,IAAK,GAELC,OAAQ,GACRC,QAAS,GACTC,GAAI,GAEJC,SAAU,GACVC,UAAW,GACXC,GAAI,GAEJC,KAAM,GACNC,GAAI,GACJC,MAAO,GACPC,KAAM,GAENC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,IAAK,IACLC,IAAK,IACLC,IAAK,KAGDC,EAAY,CAChBC,MAAO,CAAEC,QAAQ,EAAOC,SAAS,GACjCC,KAAM,CAAEF,QAAQ,EAAOC,SAAS,GAChCE,IAAK,CAAEH,QAAQ,EAAOC,SAAS,GAC/BG,KAAM,CAAEJ,QAAQ,EAAOC,SAAS,IAG9B3E,EAAE+E,UAASP,EAAUI,KAAKD,SAAU,GACpC3E,EAAEgF,WAAUR,EAAUC,MAAME,SAAU,GACtC3E,EAAEiF,SAAQT,EAAUK,IAAIF,SAAU,GAClC3E,EAAEkF,UAASV,EAAUM,KAAKH,SAAU,GAExC,IAAK,IAAIQ,EAAGC,EAAI,EAAGA,EAAIxE,EAAKyE,OAAQD,IAIxB,UAHVD,EAAIvE,EAAKwE,KAGiB,YAAND,GAClBrE,IACA0D,EAAUI,KAAKF,QAAS,GACT,UAANS,GACTrE,IACA0D,EAAUC,MAAMC,QAAS,GACV,QAANS,GACTrE,IACA0D,EAAUK,IAAIH,QAAS,GACR,SAANS,GACTrE,IACA0D,EAAUM,KAAKJ,QAAS,GACfS,EAAEE,OAAS,EAChB1D,EAAYwD,KAAOpF,GAAMe,IACpB7B,EAAIO,QACTP,EAAIO,UAAYO,GAAMe,KAEtBL,IAAc0E,GAEZpE,EAAUN,IAAcT,EAAEgF,WAC5BvE,EAAYM,EAAUN,MACJ0E,IAJDrE,IAUzB,GAAIA,IAAOF,EAAKyE,QACZb,EAAUI,KAAKD,UAAYH,EAAUI,KAAKF,QAC1CF,EAAUC,MAAME,UAAYH,EAAUC,MAAMC,QAC5CF,EAAUK,IAAIF,UAAYH,EAAUK,IAAIH,QACxCF,EAAUM,KAAKH,UAAYH,EAAUM,KAAKJ,SAC5C1F,EAASgB,IAEJf,EAAIG,WAUP,OARAY,EAAEsF,cAAe,EACjBtF,EAAEuF,aAAc,EAGZvF,EAAEwF,kBACJxF,EAAEwF,kBACFxF,EAAEyF,mBAEG,GAIbC,KAAK7G,aAAaE,GAAuB,CACvCC,SAAUa,EACVP,OAAQI,EACRQ,MAAOjB,EAAIE,MAGTO,EAAIiG,iBAAkBjG,EAAIiG,iBAAiB1G,EAAIE,KAAMU,GAAM,GACtDH,EAAIkG,YAAalG,EAAIkG,YAAJ,YAAqB3G,EAAIE,MAAQU,GACtDH,EAAI,KAAD,OAAMT,EAAIE,OAAUU,GAI9BgG,OA3Me,SA2MP9G,GACNA,EAAsBA,EAAoBa,cAC1C,IAAMkG,EAAUJ,KAAK7G,aAAaE,GAElC,UADO2G,KAAK7G,aAAaE,GACpB+G,EAAL,CACA,IAAM3G,EAAO2G,EAAQ5F,MACfR,EAAMoG,EAAQxG,OACdN,EAAW8G,EAAQ9G,SAErBU,EAAIqG,YAAarG,EAAIqG,YAAJ,YAAqB5G,GAAQH,GACzCU,EAAIsG,oBAAqBtG,EAAIsG,oBAAoB7G,EAAMH,GAAU,GACrEU,EAAI,KAAD,OAAMP,KAAU,OC3NxB8G,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,GAAGF,EAAyBE,GAC3B,OAAOF,EAAyBE,GAAUvH,QAG3C,IAAID,EAASsH,EAAyBE,GAAY,CAGjDvH,QAAS,IAOV,OAHAwH,EAAoBD,GAAUxH,EAAQA,EAAOC,QAASsH,GAG/CvH,EAAOC,Q,MCpBf,IAAMyH,EAAYC,EAAQ,KAEpBC,EAAc,SAACC,EAAM3G,GAAP,OAAgBwG,EAAUvH,IAAV,oBAA2B0H,GAAQ3G,IAEvE,SAAS4G,EAASC,GAChB,IAAMC,EAAUpH,SAASqH,cAAT,yBAAyCF,EAAzC,OACXC,EAMLpH,SAASsH,SAASC,KAAOH,EAAQI,aAAa,QALxCL,EAAKM,MAAM,oBACbzH,SAASsH,SAASC,KAAOA,EAAKG,QAAQ,IAAIC,OAAJ,WAAeR,IAAS,KAAgB,MAATI,EAAe,GAAK,KAAOJ,GAOtG,SAASS,EAAOhI,GACd,GAAII,SAASsH,SAASC,KAAKE,MAAM,4BAC/BzH,SAASsH,SAASC,KAAOvH,SAASsH,SAASC,KAAKG,QAAQ,WAAY,QADtE,CAIA,IAIIG,EAJEC,EAAWC,MAAMC,KAAKhI,SAASiI,iBAAiB,6CACtD,GAAKH,EAAShC,OAMZ+B,EAFW,QAATjI,EAEQkI,EAAS,GAAGP,KAEZO,EAASA,EAAShC,OAAS,GAAGyB,KAE1CvH,SAASsH,SAASC,KAAOM,GAG3B,SAASK,EAASC,GAChB,IAAMC,EAAOpI,SAASqH,cAAT,sBAAsCc,EAAtC,OACTC,IACFpI,SAASsH,SAASC,KAAOa,EAAKZ,aAAa,SAI/C,IAAMD,EAAOvH,SAASsH,SAASC,KAAKG,QAAQ,wBAAyB,IAEhEH,EAAKc,SAAS,UACjBrB,EAAY,KAAK,WACfhH,SAASsH,SAASC,KAAO,iBAIxBA,EAAKe,WAAW,YAAaf,EAAKc,SAAS,cAC9CrB,EAAY,KAAK,WACfE,EAAQ,WAEVF,EAAY,KAAK,WACfE,EAAQ,eAEVF,EAAY,KAAK,WACfE,EAAQ,WAEVF,EAAY,KAAK,WACfE,EAAQ,cAEVF,EAAY,KAAK,WACfY,EAAM,UAERZ,EAAY,MAAM,WAChBY,OAEFZ,EAAY,QAAQ,WAClBkB,EAAQ,eAEVlB,EAAY,SAAS,WACnBkB,EAAQ,a","file":"app-0.2.14.js","sourcesContent":["/**\r\n * http://www.openjs.com/scripts/events/keyboard_shortcuts/\r\n * Version : 2.01.B\r\n * By Binny V A\r\n * License : BSD\r\n */\r\nmodule.exports = {\r\n  allShortcuts: {}, // All the shortcuts are stored in this object\r\n\r\n  // Add the shortcut\r\n  add (shortcutCombination, callback, opt) {\r\n    // Provide a set of default options\r\n    const defaultOptions = {\r\n      type: 'keydown',\r\n      propagate: false,\r\n      disable_in_input: false,\r\n      target: document,\r\n      keycode: false\r\n    }\r\n    if (!opt) opt = defaultOptions\r\n    else {\r\n      for (const dfo in defaultOptions) {\r\n        if (typeof opt[dfo] === 'undefined') opt[dfo] = defaultOptions[dfo]\r\n      }\r\n    }\r\n\r\n    let ele = opt.target\r\n    if (typeof opt.target === 'string') ele = document.getElementById(opt.target)\r\n\r\n    shortcutCombination = shortcutCombination.toLowerCase()\r\n\r\n    // The function to be called at keypress\r\n    const func = function (e = window.event) {\r\n      if (opt.disable_in_input) { // Don't enable shortcut keys in Input, Textarea fields\r\n        let element\r\n        if (e.target) element = e.target\r\n        else if (e.srcElement) element = e.srcElement\r\n        if (element.nodeType === 3) element = element.parentNode\r\n\r\n        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') return\r\n      }\r\n\r\n      let code\r\n      // Find Which key is pressed\r\n      if (e.keyCode) code = e.keyCode\r\n      else if (e.which) code = e.which\r\n\r\n      let character = String.fromCharCode(code).toLowerCase()\r\n\r\n      if (code === 188) character = ',' // If the user presses , when the type is onkeydown\r\n      if (code === 190) character = '.' // If the user presses , when the type is onkeydown\r\n\r\n      const keys = shortcutCombination.split('+')\r\n      // Key Pressed - counts the number of valid keypresses - if it is same as the number of keys, the shortcut function is invoked\r\n      let kp = 0\r\n\r\n      // Work around for stupid Shift key bug created by using lowercase - as a result the shift+num combination was broken\r\n      const shiftNums = {\r\n        '`': '~',\r\n        1: '!',\r\n        2: '@',\r\n        3: '#',\r\n        4: '$',\r\n        5: '%',\r\n        6: '^',\r\n        7: '&',\r\n        8: '*',\r\n        9: '(',\r\n        0: ')',\r\n        '-': '_',\r\n        '=': '+',\r\n        ';': ':',\r\n        '\\'': '\"',\r\n        ',': '<',\r\n        '.': '>',\r\n        '/': '?',\r\n        '\\\\': '|'\r\n      }\r\n      // Special Keys - and their codes\r\n      const specialKeys = {\r\n        esc: 27,\r\n        escape: 27,\r\n        tab: 9,\r\n        space: 32,\r\n        return: 13,\r\n        enter: 13,\r\n        backspace: 8,\r\n\r\n        scrolllock: 145,\r\n        scroll_lock: 145,\r\n        scroll: 145,\r\n        capslock: 20,\r\n        caps_lock: 20,\r\n        caps: 20,\r\n        numlock: 144,\r\n        num_lock: 144,\r\n        num: 144,\r\n\r\n        pause: 19,\r\n        break: 19,\r\n\r\n        insert: 45,\r\n        home: 36,\r\n        delete: 46,\r\n        end: 35,\r\n\r\n        pageup: 33,\r\n        page_up: 33,\r\n        pu: 33,\r\n\r\n        pagedown: 34,\r\n        page_down: 34,\r\n        pd: 34,\r\n\r\n        left: 37,\r\n        up: 38,\r\n        right: 39,\r\n        down: 40,\r\n\r\n        f1: 112,\r\n        f2: 113,\r\n        f3: 114,\r\n        f4: 115,\r\n        f5: 116,\r\n        f6: 117,\r\n        f7: 118,\r\n        f8: 119,\r\n        f9: 120,\r\n        f10: 121,\r\n        f11: 122,\r\n        f12: 123\r\n      }\r\n\r\n      const modifiers = {\r\n        shift: { wanted: false, pressed: false },\r\n        ctrl: { wanted: false, pressed: false },\r\n        alt: { wanted: false, pressed: false },\r\n        meta: { wanted: false, pressed: false } // Meta is Mac specific\r\n      }\r\n\r\n      if (e.ctrlKey) modifiers.ctrl.pressed = true\r\n      if (e.shiftKey) modifiers.shift.pressed = true\r\n      if (e.altKey) modifiers.alt.pressed = true\r\n      if (e.metaKey) modifiers.meta.pressed = true\r\n\r\n      for (let k, i = 0; i < keys.length; i++) {\r\n        k = keys[i]\r\n\r\n        // Modifiers\r\n        if (k === 'ctrl' || k === 'control') {\r\n          kp++\r\n          modifiers.ctrl.wanted = true\r\n        } else if (k === 'shift') {\r\n          kp++\r\n          modifiers.shift.wanted = true\r\n        } else if (k === 'alt') {\r\n          kp++\r\n          modifiers.alt.wanted = true\r\n        } else if (k === 'meta') {\r\n          kp++\r\n          modifiers.meta.wanted = true\r\n        } else if (k.length > 1) { // If it is a special key\r\n          if (specialKeys[k] === code) kp++\r\n        } else if (opt.keycode) {\r\n          if (opt.keycode === code) kp++\r\n        } else { // The special keys did not match\r\n          if (character === k) kp++\r\n          else {\r\n            if (shiftNums[character] && e.shiftKey) { // Stupid Shift key bug created by using lowercase\r\n              character = shiftNums[character]\r\n              if (character === k) kp++\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (kp === keys.length &&\r\n          modifiers.ctrl.pressed === modifiers.ctrl.wanted &&\r\n          modifiers.shift.pressed === modifiers.shift.wanted &&\r\n          modifiers.alt.pressed === modifiers.alt.wanted &&\r\n          modifiers.meta.pressed === modifiers.meta.wanted) {\r\n        callback(e)\r\n\r\n        if (!opt.propagate) { // Stop the event\r\n          // e.cancelBubble is supported by IE - this will kill the bubbling process.\r\n          e.cancelBubble = true\r\n          e.returnValue = false\r\n\r\n          // e.stopPropagation works in Firefox.\r\n          if (e.stopPropagation) {\r\n            e.stopPropagation()\r\n            e.preventDefault()\r\n          }\r\n          return false\r\n        }\r\n      }\r\n    }\r\n    this.allShortcuts[shortcutCombination] = {\r\n      callback: func,\r\n      target: ele,\r\n      event: opt.type\r\n    }\r\n    // Attach the function with the event\r\n    if (ele.addEventListener) ele.addEventListener(opt.type, func, false)\r\n    else if (ele.attachEvent) ele.attachEvent(`on${opt.type}`, func)\r\n    else ele[`on${opt.type}`] = func\r\n  },\r\n\r\n  // Remove the shortcut - just specify the shortcut and I will remove the binding\r\n  remove (shortcutCombination) {\r\n    shortcutCombination = shortcutCombination.toLowerCase()\r\n    const binding = this.allShortcuts[shortcutCombination]\r\n    delete this.allShortcuts[shortcutCombination]\r\n    if (!binding) return\r\n    const type = binding.event\r\n    const ele = binding.target\r\n    const callback = binding.callback\r\n\r\n    if (ele.detachEvent) ele.detachEvent(`on${type}`, callback)\r\n    else if (ele.removeEventListener) ele.removeEventListener(type, callback, false)\r\n    else ele[`on${type}`] = false\r\n  }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const shortcuts = require('./shortcuts')\r\n\r\nconst addShortcut = (char, func) => shortcuts.add(`shift+alt+${char}`, func)\r\n\r\nfunction modeNav (stub) {\r\n  const urlLink = document.querySelector(`.fb-navigation-${stub} a`)\r\n  if (!urlLink) {\r\n    if (stub.match(/(edit|preview)/)) {\r\n      document.location.href = href.replace(new RegExp(`/${stub}`), '') + (href === '/' ? '' : '/') + stub\r\n    }\r\n    return\r\n  }\r\n  document.location.href = urlLink.getAttribute('href')\r\n}\r\n\r\nfunction upNav (type) {\r\n  if (document.location.href.match(/admin\\/instance\\/.+?\\/.+/)) {\r\n    document.location.href = document.location.href.replace(/\\/[^/]+$/, '')\r\n    return\r\n  }\r\n  const urlLinks = Array.from(document.querySelectorAll('[data-block-id=\"admin.instance--used\"] a'))\r\n  if (!urlLinks.length) {\r\n    return\r\n  }\r\n  let newHref\r\n  if (type === 'top') {\r\n    // return modeNav('instance')\r\n    newHref = urlLinks[0].href\r\n  } else {\r\n    newHref = urlLinks[urlLinks.length - 1].href\r\n  }\r\n  document.location.href = newHref\r\n}\r\n\r\nfunction flowNav (direction) {\r\n  const link = document.querySelector(`.fb-preview-${direction} a`)\r\n  if (link) {\r\n    document.location.href = link.getAttribute('href')\r\n  }\r\n}\r\n\r\nconst href = document.location.href.replace(/^https{0,1}:\\/\\/[^/]+/, '')\r\n\r\nif (!href.includes('/flow')) {\r\n  addShortcut('f', () => {\r\n    document.location.href = '/admin/flow'\r\n  })\r\n}\r\n\r\nif (!href.startsWith('/admin') || href.includes('instance')) {\r\n  addShortcut('r', () => {\r\n    modeNav('live')\r\n  })\r\n  addShortcut('i', () => {\r\n    modeNav('instance')\r\n  })\r\n  addShortcut('e', () => {\r\n    modeNav('edit')\r\n  })\r\n  addShortcut('p', () => {\r\n    modeNav('preview')\r\n  })\r\n  addShortcut('t', () => {\r\n    upNav('top')\r\n  })\r\n  addShortcut('up', () => {\r\n    upNav()\r\n  })\r\n  addShortcut('left', () => {\r\n    flowNav('previous')\r\n  })\r\n  addShortcut('right', () => {\r\n    flowNav('next')\r\n  })\r\n}\r\n"],"sourceRoot":""}