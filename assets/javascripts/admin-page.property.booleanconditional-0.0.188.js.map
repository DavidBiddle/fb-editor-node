{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/admin-page.property.booleanconditional.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","booleanConditional","document","querySelector","getOperator","operatorName","allowableOperators","filter","operator","getOperatorProperty","getIdentifier","identifierName","allowableIdentifiers","identifier","getIdentifierProperty","createSelect","values","selectedValue","selectElement","forEach","item","label","createIdentifier","condition","conditionId","map","fullTitle","asIsOperators","createOperator","type","negated","includes","operators","createValue","enums","valueName","undefined","createAnswer","endsWith","conditionsLabel","all","any","exactly","conditionsDelimiter","conditionsType","keys","createConditionsType","currentType","conditionsTypeName","conditionType","createConditions","conditions","conditionsId","conditionIdCounter","conditionParts","newConditionId","noDelete","length","createCondition","conditionsRevert","addCondition","join","valueControl","style","display","JSON","parse","stringify","conditionRemove","conditionConvert","insertAdjacentHTML","conditionContainer","conditionsToggler","jsonMode","uiImpossible","updateConditions","renderedCondition","innerHTML","showJSONMode","showJSON","uiDisplay","jsonDisplay","toggleLabel","addEventListener","e","target","targetDestination","getAttribute","targetAction","getValueDestination","push","targetIndex","replace","m1","splice","destination","destinationValue","targetValue","split","valueDestination","startsWith","substr","currentValue","numberValue","Number","isNaN","updateValueControl","formElements","forms","elements","unescape","reverse","allowableOperatorsIn","entries","yes","no","parentNode","insertBefore","nextSibling","eval","input","booleanConditionalNodeList","booleanConditionalOptions","typeValue","toString","classList","remove","index","this"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,G,o3BCjFrD,IAAMC,mBAAqBC,SAASC,cAAc,8BAE5CC,YAAc,SAACC,GACnB,OAAOC,mBAAmBC,QAAO,SAAAC,GAAQ,OAAIA,EAASA,WAAaH,KAAc,IAAM,IAEnFI,oBAAsB,SAACJ,EAAcT,GAAf,OAA4BQ,YAAYC,GAAcT,IAC5Ec,cAAgB,SAACC,GACrB,OAAOC,qBAAqBL,QAAO,SAAAM,GAAU,OAAIA,EAAWrC,OAASmC,KAAgB,IAAM,IAEvFG,sBAAwB,SAACH,EAAgBf,GAAjB,OAA8Bc,cAAcC,GAAgBf,IAEpFmB,aAAe,SAACvC,EAAMwC,EAAQC,GAClC,IAAIC,EAAgB,iBAAH,OAAoB1C,EAApB,gJAKjB,OAJAwC,EAAOG,SAAQ,SAAAC,GACbF,GAAiB,kBAAJ,OAAsBE,EAAKlC,MAA3B,YAAoC+B,IAAkBG,EAAKlC,MAAQ,YAAc,GAAjF,YAAuFkC,EAAKC,MAA5F,gBAEfH,GAAiB,YAIbI,iBAAmB,SAACC,EAAWC,GAAgB,IAC3CX,EAAeU,EAAfV,WACFG,EAASJ,qBAAqBa,KAAI,SAAAL,GACtC,MAAO,CACLlC,MAAOkC,EAAK5C,KACZ6C,MAAOD,EAAKM,cAIhB,OAD0BX,aAAa,gBAAD,OAAiBS,GAAeR,EAAQH,IAI1Ec,cAAgB,CACpB,UACA,OACA,UAEIC,eAAiB,SAACL,EAAWC,GAAgB,IAC3CX,EAAwCU,EAAxCV,WAAYL,EAA4Be,EAA5Bf,SAAUqB,EAAkBN,EAAlBM,KAAMC,EAAYP,EAAZO,QAClC,IAAKjB,EACH,MAAO,GAELiB,IACFtB,EAAW,IAAH,OAAOA,IAEjBqB,EAAOf,sBAAsBD,EAAY,QACpCc,cAAcI,SAASF,KAC1BA,EAAO,UAET,IAAMG,EAAY1B,mBAAmBC,QAAO,SAAAC,GAC1C,IAAKA,EAASqB,KACZ,OAAO,EAIT,OADoC,QAAlBrB,EAASqB,MAAkBrB,EAASqB,OAASA,KAD5C,KAKrB,OADwBd,aAAa,cAAD,OAAeS,GAAeQ,EAAWxB,IAIzEyB,YAAc,SAACV,EAAWC,GAAgB,IACtChB,EAA2Be,EAA3Bf,SAAUtB,EAAiBqC,EAAjBrC,MAAOgD,EAAUX,EAAVW,MACzB,IAAK1B,GAAyB,YAAbA,GAAuC,WAAbA,EACzC,MAAO,GAGT,IAAM2B,EAAY,WAAH,OAAcX,GAM7B,OALIU,GAAuB,OAAb1B,GAAkC,WAAbA,GAAsC,YAAbA,EAG3C,4BAAH,OAA+B2B,EAA/B,yBAA8DC,IAAVlD,EAAsB,GAAKA,EAA/E,8CAFG6B,aAAaoB,EAAWD,EAAOhD,IAO5CmD,aAAe,SAACd,GAAc,IAC1BV,EAAeU,EAAfV,WAER,OADsBA,GAAcA,EAAWyB,SAAS,OAAS,iBAAmB,kBAIhFC,gBAAkB,CACtBC,IAAK,+BACLC,IAAK,yCACLC,QAAS,kCAELC,oBAAsB,CAC1BH,IAAK,MACLC,IAAK,SACLC,QAAS,MAELE,eAAiBjE,OAAOkE,KAAKN,iBAE7BO,qBAAuB,SAACC,EAAavB,GACzC,IAAMwB,EAAqB,oBAAH,OAAuBxB,GACzCU,EAAQU,eAAenB,KAAI,SAAAwB,GAC/B,MAAO,CACL5B,MAAOkB,gBAAgBU,GACvB/D,MAAO+D,MAIX,OADqBlC,aAAaiC,EAAoBd,EAAOa,IAGzDG,iBAAmB,SAACC,GAAuC,IAA3B3B,EAA2B,uDAAb,GAAIK,EAAS,uCACzDuB,EAAe,GAAH,OAAM5B,EAAN,YAAqBK,GACnCwB,EAAqB,EACnBC,EAAiBH,EAAW1B,KAAI,SAAAF,GACpC,IAAMgC,EAAiB,GAAH,OAAMH,EAAN,YAAsBC,EAAtB,KACpBA,IACA,IAAMG,EAAiC,IAAtBL,EAAWM,OAC5B,OAAOC,gBAAgBnC,EAAWgC,EAAgBC,MAE9CG,EAAyC,IAAtBR,EAAWM,OAAX,uIAA0JL,EAA1J,0DAAiO,GACpPR,EAAiBE,qBAAqBjB,EAAML,GAC5CoC,EAAe,yIAAH,OAA4IR,EAA5I,uBAClB,8CAAwCR,GAAxC,OAAyDe,EAAzD,iDAAkHL,EAAeO,KAAf,0CAAuDlB,oBAAoBd,GAA3E,UAAlH,OAA4M+B,EAA5M,iBAGIF,gBAAkB,SAACnC,GAA0C,IAA/BC,EAA+B,uDAAjB,GAAIgC,EAAa,uCACjE,GAAyB,WAArB,QAAOjC,GAET,OADAuC,aAAaC,MAAMC,QAAU,OACtB,GAHwD,MAKjEzC,EAAY0C,KAAKC,MAAMD,KAAKE,UAAU5C,IAC9BiB,EANyD,EAMzDA,IAAKC,EANoD,EAMpDA,IAAKC,EAN+C,EAM/CA,QAClB,GAAIF,EACF,OAAOU,iBAAiBV,EAAKhB,EAAa,OAE5C,GAAIiB,EACF,OAAOS,iBAAiBT,EAAKjB,EAAa,OAE5C,GAAIkB,EACF,OAAOQ,iBAAiBR,EAASlB,EAAa,WAdiB,MAiB1CD,EAAfV,EAjByD,EAiBzDA,WACFqB,EAAQtB,qBAAqBL,QAAO,SAAAa,GAAI,OAAIA,EAAK5C,OAASqC,KAAYY,KAAI,SAAAL,GAAI,OAAIA,EAAKc,SAAO,GACpGX,EAAUW,MAAQA,EAClB,IAAIkC,EAAkB,GACF,KAAhB5C,GAAuBgC,IACzBY,EAAkB,+HAAH,OAAkI5C,EAAlI,sCAEjB,IAAM6C,EAAmB,iIAAH,OAAoI7C,GAAe,MAAnJ,8DACtB,MAAmB,cAAfX,EACF,4CAA4CwB,aAAad,GAAzD,YAAuED,iBAAiBC,EAAWC,GAAnG,YAAmHI,eAAeL,EAAWC,GAA7I,YAA6JS,YAAYV,EAAWC,IAApL,OAAmM4C,GAAnM,OAAqNC,EAArN,eADF,GAKFpE,mBAAmBqE,mBAAmB,WAAY,kHAElD,IAAMC,mBAAqBrE,SAASC,cAAc,eAC5CqE,kBAAoBtE,SAASC,cAAc,0CAE7CsE,UAAW,EACXC,cAAe,EAEbC,iBAAmB,SAACpD,GACxB,IAAMqD,EAAoBlB,gBAAgBnC,QAChBa,IAAtBwC,GACFF,cAAe,EACfH,mBAAmBM,UAAYD,EAC/BE,aAAaL,YAEbC,cAAe,EACfI,cAAa,KAGXA,aAAe,SAACC,GACpBN,WAAaM,EACb,IAAIC,EAAY,GACZC,EAAc,OACdC,EAAc,YACdH,IACFC,EAAY,OACZC,EAAc,GACdC,EAAc,gBAEZR,eACFQ,EAAc,yCAEhBX,mBAAmBR,MAAMC,QAAUgB,EACnClB,aAAaC,MAAMC,QAAUiB,EAC7BT,kBAAkBK,UAAYK,GAEhCV,kBAAkBW,iBAAiB,SAAS,WACtCT,cAGJI,cAAcL,aAGhBF,mBAAmBY,iBAAiB,SAAS,SAAUC,GACrD,IAAMC,EAASD,EAAEC,OACbC,EAAoBD,EAAOE,aAAa,oBAC5C,GAAKD,EAAL,CAGA,IAAME,EAAeH,EAAOE,aAAa,eACzC,GAAqB,QAAjBC,EACkBC,oBAAoBH,GAC5BI,KAAK,SACZ,GAAqB,WAAjBF,EAA2B,CACpC,IAAIG,EACJL,EAAoBA,EAAkBM,QAAQ,cAAc,SAACvH,EAAGwH,GAE9D,OADAF,EAAcE,EACP,MAEWJ,oBAAoBH,GAC5BQ,OAAOH,EAAa,QAC3B,GAAqB,YAAjBH,EAA4B,CACX,QAAtBF,IACFA,EAAoB,IAEtB,IAAMS,EAAcN,oBAAoBH,GAClCU,EAAmB/B,KAAKC,MAAMD,KAAKE,UAAU4B,IACnDpH,OAAOkE,KAAKkD,GAAa5E,SAAQ,SAAA3B,UACxBuG,EAAYvG,MAErBuG,EAAYvD,IAAM,CAACwD,QACd,GAAqB,WAAjBR,EAA2B,CACpC,IAAMQ,EAAmBP,oBAAoBH,GACvCS,EAAcN,oBAAoBH,EAAkBM,QAAQ,WAAY,KAC9EjH,OAAOkE,KAAKkD,GAAa5E,SAAQ,SAAA3B,UACxBuG,EAAYvG,MAErBb,OAAOkE,KAAKmD,GAAkB7E,SAAQ,SAAA3B,GACpCuG,EAAYvG,GAAOwG,EAAiBxG,MAGxCmF,iBAAiBzF,WAEnBqF,mBAAmBY,iBAAiB,UAAU,SAAUC,GACtD,IAAMC,EAASD,EAAEC,OACbY,EAAcZ,EAAOnG,MAFgC,iBAG/BmG,EAAO7G,KAAK0H,MAAM,OAHa,GAGpD1H,EAHoD,KAG9CuH,EAH8C,KAKnDI,EAAmBV,oBADzBM,EAAcA,GAAe,IAE7B,GAAa,eAATvH,SACK2H,EAAiB3F,gBACjB2F,EAAiBjH,WACnB,GAAa,aAATV,EACLyH,EAAYG,WAAW,MACzBH,EAAcA,EAAYI,OAAO,GACjCF,EAAiBrE,SAAU,UAEpBqE,EAAiBrE,QAEN,YAAhBmE,GAA6C,WAAhBA,UACxBE,EAAiBjH,WAErB,GAAa,mBAATV,EAA2B,CACpC,IAAI8H,EAAe,GACnB1D,eAAezB,SAAQ,SAAAU,GACjBsE,EAAiBtE,KACnByE,EAAeH,EAAiBtE,UACzBsE,EAAiBtE,OAG5BsE,EAAiBF,GAAeK,EAElC,GAAa,UAAT9H,GAAoC,KAAhByH,GAGJ,WAFAxF,oBAAoBvB,MAAMsB,SAAU,QAE1B,CAC1B,IAAM+F,EAAcC,OAAOP,GACtBQ,MAAMF,KACTN,EAAcM,GAIpBJ,EAAiB3H,GAAQyH,EACzBS,mBAAmB,aACnB/B,iBAAiBzF,UAGnB,IAAMyH,aAAezG,SAAS0G,MAAM,GAAGC,SAEjCvG,mBAAqB,GACrBM,qBAAuBqD,KAAKC,MAAM4C,SAASH,aAAa1G,mBAAmBf,QAAQ6H,UACnFC,qBAAuB/C,KAAKC,MAAM4C,SAASH,aAAarG,mBAAmBpB,QAEjFP,OAAOsI,QAAQD,sBAAsB7F,SAAQ,YAA8B,0BAA5B3B,EAA4B,YAArBqC,EAAqB,EAArBA,KAAMqF,EAAe,EAAfA,IAAKC,EAAU,EAAVA,GAC/D7G,mBAAmBoF,KAAK,CACtBlF,SAAUhB,EACVqC,OACA3C,MAAOM,EACP6B,MAAO6F,IAET5G,mBAAmBoF,KAAK,CACtBlF,SAAUhB,EACVqC,OACA3C,MAAO,IAAF,OAAMM,GACX6B,MAAO8F,OAIX,IAAMrD,aAAe6C,aAAazH,MAClC4E,aAAaqB,iBAAiB,UAAU,WACtCjG,MAAQ+E,KAAKC,MAAMJ,aAAa5E,OAChCyF,iBAAiBzF,UAGnBqF,mBAAmB6C,WAAWC,aAAavD,aAAcS,mBAAmB+C,aAE5E,IAAIpI,MAAQ4E,aAAa5E,MAAQ+E,KAAKC,MAAMJ,aAAa5E,OAAS4E,aAAa5E,MAEzEuG,oBAAsB,SAAtBA,oBAAuBM,aAC3B,IAAII,iBAEJ,OADAoB,KAAK,2BAAD,OAA4BxB,cACzBI,kBAGHO,mBAAqB,SAACc,GACZ,cAAVA,GACFtI,MAAQA,OAAS,CAAE2B,WAAY,GAAIL,SAAU,IAC7CgH,EAAQvD,KAAKE,UAAUjF,MAAO,KAAM,IAEpCA,WAAQkD,EAEV0B,aAAa5E,MAAQsI,GAGjBC,2BAA6Bd,aAAae,0BAE1CC,UAA6B,kBAAVzI,MAAsBA,MAAM0I,WAAa,YAC7C,kBAAV1I,QACTA,WAAQkD,GAGVqF,2BAA2BvI,MAAQyI,UAEnC1H,mBAAmB4H,UAAUC,OAAO,aAEpC,IAAK,IAAIC,MAAQ,EAAGA,MAAQ,EAAGA,QAC7BN,2BAA2BrG,KAAK2G,OAAO5C,iBAAiB,UAAU,WAChEuB,mBAAmBsB,KAAK9I,OACxByF,iBAAiBzF,UAIA,WAAjB,QAAOA,OACTyF,iBAAiBzF,OAEjB4E,aAAaC,MAAMC,QAAU","file":"admin-page.property.booleanconditional-0.0.188.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\r\nconst booleanConditional = document.querySelector('.booleanConditionalOptions')\r\n\r\nconst getOperator = (operatorName) => {\r\n  return allowableOperators.filter(operator => operator.operator === operatorName)[0] || {}\r\n}\r\nconst getOperatorProperty = (operatorName, property) => getOperator(operatorName)[property]\r\nconst getIdentifier = (identifierName) => {\r\n  return allowableIdentifiers.filter(identifier => identifier.name === identifierName)[0] || {}\r\n}\r\nconst getIdentifierProperty = (identifierName, property) => getIdentifier(identifierName)[property]\r\n\r\nconst createSelect = (name, values, selectedValue) => {\r\n  let selectElement = `<select name=\"${name}\" class=\"govuk-select\" style=\"width:auto; min-width: 10rem; max-width:100%; display:block;margin-bottom: 0.5rem;\"><option value=\"\"></option>`\r\n  values.forEach(item => {\r\n    selectElement += `<option value=\"${item.value}\"${selectedValue === item.value ? ' selected' : ''}>${item.label}</option>`\r\n  })\r\n  selectElement += '<select>'\r\n  return selectElement\r\n}\r\n\r\nconst createIdentifier = (condition, conditionId) => {\r\n  const { identifier } = condition\r\n  const values = allowableIdentifiers.map(item => {\r\n    return {\r\n      value: item.name,\r\n      label: item.fullTitle // + ' (' + item.name + ')'\r\n    }\r\n  })\r\n  const identifierElement = createSelect(`identifier===${conditionId}`, values, identifier)\r\n  return identifierElement\r\n}\r\n\r\nconst asIsOperators = [\r\n  'boolean',\r\n  'date',\r\n  'number'\r\n]\r\nconst createOperator = (condition, conditionId) => {\r\n  let { identifier, operator, type, negated } = condition\r\n  if (!identifier) {\r\n    return ''\r\n  }\r\n  if (negated) {\r\n    operator = `!${operator}`\r\n  }\r\n  type = getIdentifierProperty(identifier, 'type')\r\n  if (!asIsOperators.includes(type)) {\r\n    type = 'string'\r\n  }\r\n  const operators = allowableOperators.filter(operator => {\r\n    if (!operator.type) {\r\n      return true\r\n    }\r\n    const enumsMatch = true\r\n    const typeMatch = operator.type === 'any' || operator.type === type\r\n    return typeMatch && enumsMatch\r\n  })\r\n  const operatorElement = createSelect(`operator===${conditionId}`, operators, operator)\r\n  return operatorElement\r\n}\r\n\r\nconst createValue = (condition, conditionId) => {\r\n  const { operator, value, enums } = condition\r\n  if (!operator || operator === 'defined' || operator === 'isTrue') {\r\n    return ''\r\n  }\r\n  let valueElement\r\n  const valueName = `value===${conditionId}`\r\n  if (enums && (operator === 'is' || operator === 'equals' || operator === 'defined')) {\r\n    valueElement = createSelect(valueName, enums, value)\r\n  } else {\r\n    valueElement = `<input type=\"text\" name=\"${valueName}\" value=\"${value === undefined ? '' : value}\" class=\"govuk-input\" style=\"width:10em;\">`\r\n  }\r\n  return valueElement\r\n}\r\n\r\nconst createAnswer = (condition) => {\r\n  const { identifier } = condition\r\n  const answerElement = identifier && identifier.endsWith('[*]') ? 'any answer for' : 'the answer for'\r\n  return answerElement\r\n}\r\n\r\nconst conditionsLabel = {\r\n  all: 'all these conditions are met',\r\n  any: 'at least one of these conditons is met',\r\n  exactly: 'one of these conditions is met'\r\n}\r\nconst conditionsDelimiter = {\r\n  all: 'and',\r\n  any: 'and/or',\r\n  exactly: 'or'\r\n}\r\nconst conditionsType = Object.keys(conditionsLabel)\r\n\r\nconst createConditionsType = (currentType, conditionId) => {\r\n  const conditionsTypeName = `conditionsType===${conditionId}`\r\n  const enums = conditionsType.map(conditionType => {\r\n    return {\r\n      label: conditionsLabel[conditionType],\r\n      value: conditionType\r\n    }\r\n  })\r\n  const valueElement = createSelect(conditionsTypeName, enums, currentType)\r\n  return valueElement\r\n}\r\nconst createConditions = (conditions, conditionId = '', type) => {\r\n  const conditionsId = `${conditionId}.${type}`\r\n  let conditionIdCounter = 0\r\n  const conditionParts = conditions.map(condition => {\r\n    const newConditionId = `${conditionsId}[${conditionIdCounter}]`\r\n    conditionIdCounter++\r\n    const noDelete = conditions.length === 1\r\n    return createCondition(condition, newConditionId, noDelete)\r\n  })\r\n  const conditionsRevert = conditions.length === 1 ? `<p class=\"govuk-button fb-action-secondary fb-action--revert-conditions condition-action condition-revert\" data-destination=\"${conditionsId}\" data-action=\"revert\">Convert to single condition</p>` : ''\r\n  const conditionsType = createConditionsType(type, conditionId)\r\n  const addCondition = `<p class=\"govuk-button fb-action-secondary fb-action--add fb-action--add-condition conditionsAdd\" data-action=\"add\" data-destination=\"${conditionsId}\">Add condition</p>`\r\n  return `<div class=\"conditions-block\">${conditionsType}${conditionsRevert}<div class=\"conditions-subconditions\">${conditionParts.join(`<p class=\"conditions-delimiter\">${conditionsDelimiter[type]}</p>`)}${addCondition}</div></div>`\r\n}\r\n\r\nconst createCondition = (condition, conditionId = '', noDelete) => {\r\n  if (typeof condition !== 'object') {\r\n    valueControl.style.display = 'none'\r\n    return ''\r\n  }\r\n  condition = JSON.parse(JSON.stringify(condition))\r\n  const { all, any, exactly } = condition\r\n  if (all) {\r\n    return createConditions(all, conditionId, 'all')\r\n  }\r\n  if (any) {\r\n    return createConditions(any, conditionId, 'any')\r\n  }\r\n  if (exactly) {\r\n    return createConditions(exactly, conditionId, 'exactly')\r\n  }\r\n  // console.log('conditionId', conditionId)\r\n  const { identifier } = condition\r\n  const enums = allowableIdentifiers.filter(item => item.name === identifier).map(item => item.enums)[0]\r\n  condition.enums = enums\r\n  let conditionRemove = ''\r\n  if (conditionId !== '' && !noDelete) {\r\n    conditionRemove = `<p class=\"govuk-button fb-action-secondary fb-action--remove-condition condition-action condition-remove\" data-destination=\"${conditionId}\" data-action=\"remove\">Delete</p>`\r\n  }\r\n  const conditionConvert = `<p class=\"govuk-button fb-action-secondary fb-action--convert-condition condition-action condition-convert\" data-destination=\"${conditionId || 'TOP'}\" data-action=\"convert\">Convert to multiple conditions</p>`\r\n  if (identifier !== 'undefined') {\r\n    return `<div class=\"condition-individual\">${createAnswer(condition)} ${createIdentifier(condition, conditionId)} ${createOperator(condition, conditionId)} ${createValue(condition, conditionId)}${conditionRemove}${conditionConvert}</div>`\r\n  }\r\n}\r\n\r\nbooleanConditional.insertAdjacentHTML('afterend', '<div id=\"conditions\"></div><p id=\"conditionsToggle\"><span class=\"govuk-button fb-action-secondary\"></span></p>')\r\n\r\nconst conditionContainer = document.querySelector('#conditions')\r\nconst conditionsToggler = document.querySelector('#conditionsToggle .fb-action-secondary')\r\n\r\nlet jsonMode = false\r\nlet uiImpossible = false\r\n\r\nconst updateConditions = (condition) => {\r\n  const renderedCondition = createCondition(condition)\r\n  if (renderedCondition !== undefined) {\r\n    uiImpossible = false\r\n    conditionContainer.innerHTML = renderedCondition\r\n    showJSONMode(jsonMode)\r\n  } else {\r\n    uiImpossible = true\r\n    showJSONMode(true)\r\n  }\r\n}\r\nconst showJSONMode = (showJSON) => {\r\n  jsonMode = !!showJSON\r\n  let uiDisplay = ''\r\n  let jsonDisplay = 'none'\r\n  let toggleLabel = 'Edit JSON'\r\n  if (showJSON) {\r\n    uiDisplay = 'none'\r\n    jsonDisplay = ''\r\n    toggleLabel = 'Edit with UI'\r\n  }\r\n  if (uiImpossible) {\r\n    toggleLabel = 'Cannot show JSON structure through UI'\r\n  }\r\n  conditionContainer.style.display = uiDisplay\r\n  valueControl.style.display = jsonDisplay\r\n  conditionsToggler.innerHTML = toggleLabel\r\n}\r\nconditionsToggler.addEventListener('click', () => {\r\n  if (uiImpossible) {\r\n    return\r\n  }\r\n  showJSONMode(!jsonMode)\r\n})\r\n\r\nconditionContainer.addEventListener('click', function (e) {\r\n  const target = e.target\r\n  let targetDestination = target.getAttribute('data-destination')\r\n  if (!targetDestination) {\r\n    return\r\n  }\r\n  const targetAction = target.getAttribute('data-action')\r\n  if (targetAction === 'add') {\r\n    const destination = getValueDestination(targetDestination)\r\n    destination.push({})\r\n  } else if (targetAction === 'remove') {\r\n    let targetIndex\r\n    targetDestination = targetDestination.replace(/\\[(\\d+)\\]$/, (m, m1) => {\r\n      targetIndex = m1\r\n      return ''\r\n    })\r\n    const destination = getValueDestination(targetDestination)\r\n    destination.splice(targetIndex, 1)\r\n  } else if (targetAction === 'convert') {\r\n    if (targetDestination === 'TOP') {\r\n      targetDestination = ''\r\n    }\r\n    const destination = getValueDestination(targetDestination)\r\n    const destinationValue = JSON.parse(JSON.stringify(destination))\r\n    Object.keys(destination).forEach(key => {\r\n      delete destination[key]\r\n    })\r\n    destination.all = [destinationValue]\r\n  } else if (targetAction === 'revert') {\r\n    const destinationValue = getValueDestination(targetDestination)\r\n    const destination = getValueDestination(targetDestination.replace(/\\.[^.]+$/, ''))\r\n    Object.keys(destination).forEach(key => {\r\n      delete destination[key]\r\n    })\r\n    Object.keys(destinationValue).forEach(key => {\r\n      destination[key] = destinationValue[key]\r\n    })\r\n  }\r\n  updateConditions(value)\r\n})\r\nconditionContainer.addEventListener('change', function (e) {\r\n  const target = e.target\r\n  let targetValue = target.value\r\n  let [name, destination] = target.name.split('===')\r\n  destination = destination || ''\r\n  const valueDestination = getValueDestination(destination)\r\n  if (name === 'identifier') {\r\n    delete valueDestination.operator\r\n    delete valueDestination.value\r\n  } else if (name === 'operator') {\r\n    if (targetValue.startsWith('!')) {\r\n      targetValue = targetValue.substr(1)\r\n      valueDestination.negated = true\r\n    } else {\r\n      delete valueDestination.negated\r\n    }\r\n    if (targetValue === 'defined' || targetValue === 'isTrue') {\r\n      delete valueDestination.value\r\n    }\r\n  } else if (name === 'conditionsType') {\r\n    let currentValue = []\r\n    conditionsType.forEach(type => {\r\n      if (valueDestination[type]) {\r\n        currentValue = valueDestination[type]\r\n        delete valueDestination[type]\r\n      }\r\n    })\r\n    valueDestination[targetValue] = currentValue\r\n  }\r\n  if (name === 'value' && targetValue !== '') {\r\n    const valueType = getOperatorProperty(value.operator, 'type')\r\n    // allowableOperators.filter(operator => operator.operator === value.operator)[0].type\r\n    if (valueType === 'number') {\r\n      const numberValue = Number(targetValue)\r\n      if (!isNaN(numberValue)) {\r\n        targetValue = numberValue\r\n      }\r\n    }\r\n  }\r\n  valueDestination[name] = targetValue\r\n  updateValueControl('condition')\r\n  updateConditions(value)\r\n})\r\n\r\nconst formElements = document.forms[0].elements\r\n\r\nconst allowableOperators = []\r\nconst allowableIdentifiers = JSON.parse(unescape(formElements.booleanConditional.value)).reverse()\r\nconst allowableOperatorsIn = JSON.parse(unescape(formElements.allowableOperators.value))\r\n\r\nObject.entries(allowableOperatorsIn).forEach(([key, { type, yes, no }]) => {\r\n  allowableOperators.push({\r\n    operator: key,\r\n    type,\r\n    value: key,\r\n    label: yes\r\n  })\r\n  allowableOperators.push({\r\n    operator: key,\r\n    type,\r\n    value: `!${key}`,\r\n    label: no\r\n  })\r\n})\r\n\r\nconst valueControl = formElements.value\r\nvalueControl.addEventListener('change', () => {\r\n  value = JSON.parse(valueControl.value)\r\n  updateConditions(value)\r\n})\r\n\r\nconditionContainer.parentNode.insertBefore(valueControl, conditionContainer.nextSibling)\r\n\r\nlet value = valueControl.value ? JSON.parse(valueControl.value) : valueControl.value\r\n\r\nconst getValueDestination = (destination) => {\r\n  let valueDestination\r\n  eval(`valueDestination = value${destination}`) // eslint-disable-line no-eval\r\n  return valueDestination\r\n}\r\n\r\nconst updateValueControl = (input) => {\r\n  if (input === 'condition') {\r\n    value = value || { identifier: '', operator: '' }\r\n    input = JSON.stringify(value, null, 2)\r\n  } else {\r\n    value = undefined\r\n  }\r\n  valueControl.value = input\r\n}\r\n\r\nconst booleanConditionalNodeList = formElements.booleanConditionalOptions\r\n\r\nconst typeValue = typeof value === 'boolean' ? value.toString() : 'condition'\r\nif (typeof value === 'boolean') {\r\n  value = undefined\r\n}\r\n\r\nbooleanConditionalNodeList.value = typeValue\r\n\r\nbooleanConditional.classList.remove('js-hidden')\r\n\r\nfor (let index = 0; index < 3; index++) {\r\n  booleanConditionalNodeList.item(index).addEventListener('change', function () {\r\n    updateValueControl(this.value)\r\n    updateConditions(value)\r\n  })\r\n}\r\n\r\nif (typeof value === 'object') {\r\n  updateConditions(value)\r\n} else {\r\n  valueControl.style.display = 'none'\r\n}\r\n"],"sourceRoot":""}